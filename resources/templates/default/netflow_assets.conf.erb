filter {
  # 1. Map CLIENT MAC with asset type ID
  translate {
    field => "[client_mac]"
    destination => "[asset_type_id]"
    dictionary_path => "/etc/logstash/asset_type_id.yaml"
    override => true
  }

  # 2. Map ASSET TYPE ID with asset type name
  translate {
    field => "[asset_type_id]"
    destination => "[asset_type_name]"
    dictionary_path => "/etc/logstash/asset_type_name.yaml"
    override => true
  }

  # Clean up if asset_type_id not found
  if ![asset_type_id] and [asset_type_name] {
    mutate {
      remove_field => ["asset_type_name"]
    }
  }

  # Clean up if asset_type_name not found
  if ![asset_type_name] and [asset_type_id] {
    mutate {
      remove_field => ["asset_type_id"]
    }
  }
}